<script src="../bower_components/webcomponentsjs/webcomponents-loader.js"></script>
<link rel="import" href="../bower_components/polymer/polymer-element.html">

<dom-module id="demo-element">

  <template>
    <p>iframe child element</p>
  </template>

  <script>
    window.addEventListener("WebComponentsReady", () => {

      class DemoElement extends Polymer.Element {

        static get is() {
          return "demo-element"
        }

        static get properties() {
          return {
          }
        }

        ready() {
          super.ready()

          const target = document.body
          target.addEventListener("parent-to-child", event => {
            console.log("[iframe-child] received event", event.detail, event.target)
          })
          console.log("[iframe-child] added event listener")

          setTimeout(() => {
            console.log("[iframe-child] dispatch event")
            target.setAttribute("data-child", "child")
            target.dispatchEvent(new CustomEvent("child-to-parent"), {
              detail: {
                text: "child"
              }
            })
          }, 2000)
        }

      }

      window.customElements.define(DemoElement.is, DemoElement)

    })
  </script>

</dom-module>

<body>
  <demo-element></demo-element>
</body>
